<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>æ„›ã•ã‚Œæ‰‹ç›¸è¨ºæ–­ï½œå°åˆ·OK</title>
  <style>
    :root{ --bg:#0b0f1a; --card:#121a2b; --ink:#eaf0ff; --muted:#a9b6d6; --acc:#ffd166; --acc2:#7bdff2; }
    *{ box-sizing:border-box; }
    body{ margin:0; font-family: system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif; background: radial-gradient(1200px 800px at 20% 0%, #1a2650 0%, var(--bg) 60%); color:var(--ink); }
    header{ padding:18px 16px 8px; position:sticky; top:0; backdrop-filter: blur(10px); background: rgba(11,15,26,.55); border-bottom:1px solid rgba(255,255,255,.08); z-index:5;}
    header h1{ margin:0; font-size:18px; letter-spacing:.02em; }
    header p{ margin:6px 0 0; color:var(--muted); font-size:12px; }

    .wrap{ max-width:980px; margin:0 auto; padding:14px 12px 40px; display:grid; gap:12px; grid-template-columns: 1fr; }
    @media (min-width:900px){ .wrap{ grid-template-columns: 1.1fr .9fr; } }

    .card{ background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03)); border:1px solid rgba(255,255,255,.09); border-radius:14px; padding:14px; box-shadow: 0 12px 30px rgba(0,0,0,.35); }
    .card h2{ margin:0 0 10px; font-size:14px; color: #ffffff; display:flex; align-items:center; gap:8px; }
    .badge{ display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.15); background: rgba(255,255,255,.04); font-size:12px; color:var(--muted); }
    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    input[type="text"]{ width:min(380px, 100%); padding:12px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.14); background: rgba(0,0,0,.25); color:var(--ink); outline:none; }
    input[type="file"]{ width:100%; }
    .help{ color:var(--muted); font-size:12px; line-height:1.6; margin:8px 0 0; }

    .grid{ display:grid; grid-template-columns: 1fr; gap:10px; }
    @media (min-width:520px){ .grid{ grid-template-columns: 1fr 1fr; } }
    .opt{ padding:10px 10px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background: rgba(0,0,0,.18); display:flex; gap:10px; align-items:flex-start; }
    .opt input{ transform: translateY(2px); }
    .opt .t{ font-size:13px; }
    .opt .d{ font-size:11px; color:var(--muted); margin-top:4px; line-height:1.4; }

    .btns{ display:flex; gap:10px; flex-wrap:wrap; }
    button{ cursor:pointer; border:0; padding:12px 14px; border-radius:12px; font-weight:700; letter-spacing:.02em; }
    .primary{ background: linear-gradient(90deg, var(--acc), #ff8fab); color:#131725; }
    .ghost{ background: rgba(255,255,255,.06); color: var(--ink); border:1px solid rgba(255,255,255,.14); }
    .danger{ background: rgba(255,120,120,.15); color:#ffdede; border:1px solid rgba(255,120,120,.25); }

    .result{ display:none; }
    .result.show{ display:block; }
    .hero{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between; }
    .title{ font-size:18px; margin:0; }
    .subtitle{ margin:6px 0 0; color:var(--muted); font-size:12px; }
    .score{ display:flex; gap:10px; align-items:center; }
    .meter{ width:160px; height:10px; border-radius:999px; background: rgba(255,255,255,.12); overflow:hidden; }
    .bar{ height:100%; width:50%; background: linear-gradient(90deg, var(--acc2), var(--acc)); }
    .pill{ padding:8px 12px; border-radius:999px; background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.14); font-size:12px; color:var(--ink); }

    .two{ display:grid; gap:10px; grid-template-columns: 1fr; margin-top:10px; }
    @media (min-width:700px){ .two{ grid-template-columns: 1fr 1fr; } }

    .k{ font-size:12px; color:var(--muted); }
    .v{ font-size:13px; line-height:1.7; margin-top:4px; }
    .callout{ border-left:3px solid var(--acc); padding-left:10px; margin:10px 0 0; color:#fff; }
    .small{ font-size:11px; color:var(--muted); margin-top:10px; }

    .preview{ display:flex; gap:10px; align-items:flex-start; }
    .preview img{ max-width:190px; border-radius:12px; border:1px solid rgba(255,255,255,.12); display:none; }
    .preview .ph{ flex:1; min-width:160px; }

    /* å°åˆ· */
    @media print{
      header, .no-print{ display:none !important; }
      body{ background:#fff; color:#111; }
      .card{ box-shadow:none; border:1px solid #ddd; background:#fff; }
      .badge, .pill{ border:1px solid #ddd; background:#f6f6f6; color:#111; }
      .meter{ background:#eee; }
      .bar{ background:#111; }
      a{ color:#111; text-decoration:none; }
    }
  </style>
</head>
<body>
<header class="no-print">
  <h1>æ„›ã•ã‚Œæ‰‹ç›¸è¨ºæ–­ ğŸ”®ï¼ˆGitHub Pagesç‰ˆï¼‰</h1>
  <p>è»½ãå‹•ãï¼å¥³æ€§ã‚¦ã‚±ã®å‡ºåŠ›ã«å…¨æŒ¯ã‚Šï¼çµæœã¯ãã®ã¾ã¾å°åˆ·ã§ãã‚‹</p>
</header>

<div class="wrap">
  <section class="card no-print">
    <h2>â‘  å…¥åŠ›</h2>

    <div class="row">
      <span class="badge">æœªæ¥ã‚’è¦‹ã‚‹ãªã‚‰å³æ‰‹ãŒãŠã™ã™ã‚</span>
      <span class="badge">å·¦æ‰‹ã¯ã€Œéš ã‚Œé­…åŠ›ã€</span>
    </div>

    <div style="margin-top:10px;">
      <label class="k">ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ï¼ˆä»»æ„ï¼‰</label><br>
      <input id="name" type="text" placeholder="ä¾‹ï¼šã¿ã‚† / ã²ã§ãŠã•ã‚“ã®å½¼å¥³ ãªã©">
      <div class="help">å‡ºåŠ›ã«åå‰ãŒå…¥ã‚‹ã¨ã€ã€Œè‡ªåˆ†ã®è¨ºæ–­ã€æ„ŸãŒå¢—ãˆã¦æº€è¶³åº¦ãŒä¸ŠãŒã‚‹ã‚ˆã€‚</div>
    </div>

    <div style="margin-top:12px;" class="preview">
      <div class="ph">
        <label class="k">æ‰‹ã®å†™çœŸï¼ˆä»»æ„ï¼šè§£æã¯ã—ãªã„ï¼çµæœãƒšãƒ¼ã‚¸ã«è²¼ã‚Œã‚‹ï¼‰</label><br>
        <input id="photo" type="file" accept="image/*">
        <div class="help">â€œå†™çœŸãŒè¼‰ã‚‹ï¼å°åˆ·ã—ãŸã¨ãã«ç‰¹åˆ¥æ„Ÿâ€ãŒå‡ºã‚‹ã€‚ã¾ãšã¯ã“ã“ã ã‘ã§ååˆ†ã‚¦ã‚±ã‚‹ã€‚</div>
      </div>
      <img id="photoPreview" alt="æ‰‹ã®å†™çœŸãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼">
    </div>
  </section>

  <section class="card no-print">
    <h2>â‘¡ ãƒã‚§ãƒƒã‚¯ï¼ˆå¥³æ€§ãŒå–œã¶é …ç›®ã«é›†ä¸­ï¼‰</h2>
    <div class="grid" id="checks"></div>

    <div class="btns" style="margin-top:12px;">
      <button class="primary" id="go">è¨ºæ–­ã™ã‚‹</button>
      <button class="ghost" id="rand">ã„ã„æ„Ÿã˜ã«ãƒã‚§ãƒƒã‚¯ï¼ˆç››ã‚‹ï¼‰</button>
      <button class="danger" id="reset">ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <div class="help">â€»ã€Œç››ã‚‹ã€ãƒœã‚¿ãƒ³ã¯ãƒã‚ºç”¨ã€‚æ°—åˆ†ãŒä¸ŠãŒã‚‹ä½“é¨“ã«æŒ¯ã‚Šåˆ‡ã£ã¦ã‚‹ã€‚</div>
  </section>

  <section class="card result" id="resultCard">
    <h2>â‘¢ è¨ºæ–­çµæœï¼ˆå°åˆ·OKï¼‰</h2>

    <div class="hero">
      <div>
        <p class="title" id="title">ç§°å·</p>
        <p class="subtitle" id="subtitle">ã‚µãƒ–</p>
      </div>
      <div class="score">
        <div>
          <div class="k">æ„›ã•ã‚ŒæŒ‡æ•°</div>
          <div class="meter"><div class="bar" id="bar"></div></div>
        </div>
        <div class="pill" id="scorePill">85 / 100</div>
      </div>
    </div>

    <div class="two">
      <div class="card" style="padding:12px;">
        <div class="k">æ‹æ„›ãƒ»çµå©š</div>
        <div class="v" id="love"></div>
        <div class="callout v" id="timing"></div>
      </div>
      <div class="card" style="padding:12px;">
        <div class="k">å¹¸é‹ãƒ»æˆåŠŸ</div>
        <div class="v" id="luck"></div>
        <div class="callout v" id="action"></div>
      </div>
    </div>

    <div class="card" style="padding:12px; margin-top:10px;">
      <div class="k">ã‚ãªãŸã®æ‰‹ã®å†™çœŸï¼ˆä»»æ„ï¼‰</div>
      <div class="v">
        <img id="photoResult" style="max-width:260px; border-radius:12px; border:1px solid rgba(255,255,255,.12); display:none;" alt="çµæœã«è¼‰ã‚‹å†™çœŸ">
        <div class="small" id="photoNote"></div>
      </div>
    </div>

    <div class="btns no-print" style="margin-top:12px;">
      <button class="primary" id="print">å°åˆ·ã™ã‚‹</button>
      <button class="ghost" id="share">Xã‚·ã‚§ã‚¢æ–‡ã‚³ãƒ”ãƒ¼</button>
    </div>

    <div class="small">
      â€»ã“ã‚Œã¯ã‚¨ãƒ³ã‚¿ãƒ¡è¨ºæ–­ã€‚æ°—åˆ†ãŒä¸ŠãŒã‚‹æ–¹å‘ã§èª­ã‚€ã®ãŒæ­£è§£ã€‚<br>
      å°åˆ·ï¼šã‚¹ãƒãƒ›ãªã‚‰ã€Œå…±æœ‰ â†’ ãƒ—ãƒªãƒ³ãƒˆã€ã¾ãŸã¯ã€Œå°åˆ· â†’ PDFã«ä¿å­˜ã€ã‚‚ã§ãã‚‹ã‚ˆã€‚
    </div>
  </section>
</div>

<script>
  // å¥³æ€§ã‚¦ã‚±è¦ç´ ã«é›†ä¸­ã—ãŸãƒã‚§ãƒƒã‚¯é …ç›®ï¼ˆï¼è»½ã„ï¼‰
  const ITEMS = [
    { id:"venusBand",  title:"é‡‘æ˜Ÿå¸¯ï¼ˆãƒ¢ãƒ†ç·šï¼‰ãŒã‚ã‚‹", desc:"æ³¨ç›®ã•ã‚Œã‚„ã™ãã€æ„›ã•ã‚Œã‚­ãƒ£ãƒ©ã«ãªã‚Šã‚„ã™ã„" , w:18 },
    { id:"sunLine",    title:"å¤ªé™½ç·šãŒå‡ºã¦ã„ã‚‹",         desc:"äººæ°—é‹ãƒ»æˆåŠŸé‹ã€‚äººã«å¿œæ´ã•ã‚Œã‚‹ã‚¿ã‚¤ãƒ—",       w:16 },
    { id:"emotionFork",title:"æ„Ÿæƒ…ç·šã®å…ˆãŒæåˆ†ã‹ã‚Œ",     desc:"æ„›æƒ…æ·±ãã€æ‹ãŒè‚²ã¡ã‚„ã™ã„ã€‚ãƒ¢ãƒ†è¦ç´ ã‚‚",       w:14 },
    { id:"marriageMany",title:"çµå©šç·šãŒ2æœ¬ä»¥ä¸Š",         desc:"ãƒãƒ£ãƒ³ã‚¹ãŒè¤‡æ•°ã€‚é¸ã¹ã‚‹ç«‹å ´ã«ãªã‚Šã‚„ã™ã„",     w:12 },
    { id:"marriageDeep",title:"çµå©šç·šãŒæ¿ƒã„/é•·ã„",       desc:"çœŸå‰£ãªã”ç¸ãŒå…¥ã‚Šã‚„ã™ã„ã€‚é–¢ä¿‚ãŒå½¢ã«ãªã‚Šã‚„ã™ã„", w:12 },
    { id:"loveLine",   title:"æ‹æ„›ç·šã£ã½ã„ç·šãŒã‚ã‚‹",     desc:"é‹å‘½çš„ãªå‡ºä¼šã„ã®ã‚¹ã‚¤ãƒƒãƒãŒå…¥ã‚Šã‚„ã™ã„",       w:10 },
    { id:"star",       title:"ã‚¹ã‚¿ãƒ¼ç·šï¼ˆæ˜Ÿï¼‰ãŒã‚ã‚‹",     desc:"äºˆæœŸã›ã¬å¹¸é‹ãƒ»ãƒ¢ãƒ†æœŸãŒæ¥ã‚‹ã‚µã‚¤ãƒ³ï¼ˆãƒ¬ã‚¢ï¼‰",    w:18, rare:true },
    { id:"solomon",    title:"ã‚½ãƒ­ãƒ¢ãƒ³ã®æ˜ŸãŒã‚ã‚‹",       desc:"ã‚«ãƒªã‚¹ãƒé‹ãƒ»æˆåŠŸé‹ï¼ˆè¶…ãƒ¬ã‚¢æ¼”å‡ºæ ï¼‰",          w:22, ultra:true },
    { id:"venusHill",  title:"é‡‘æ˜Ÿä¸˜ãŒãµã£ãã‚‰",         desc:"æ„›æƒ…ã¨ç”Ÿå‘½åŠ›ã€‚å¤§äº‹ã«ã•ã‚Œã‚„ã™ã„ç©ºæ°—æ„Ÿ",        w:10 },
    { id:"moonHill",   title:"æœˆä¸˜ãŒç›®ç«‹ã¤",             desc:"ä¸æ€è­°ãªé­…åŠ›ã€‚å®ˆã£ã¦ã‚ã’ãŸããªã‚‹é›°å›²æ°—",      w:8 },
  ];

  const checksEl = document.getElementById("checks");
  const nameEl = document.getElementById("name");
  const resultCard = document.getElementById("resultCard");

  function renderChecks(){
    checksEl.innerHTML = ITEMS.map(it => `
      <label class="opt">
        <input type="checkbox" id="${it.id}">
        <div>
          <div class="t">${it.title} ${it.ultra ? "ğŸ‘‘" : it.rare ? "âœ¨" : ""}</div>
          <div class="d">${it.desc}</div>
        </div>
      </label>
    `).join("");
  }
  renderChecks();

  // å†™çœŸãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆè§£æãªã—ï¼‰
  const photoInput = document.getElementById("photo");
  const photoPreview = document.getElementById("photoPreview");
  const photoResult = document.getElementById("photoResult");
  const photoNote = document.getElementById("photoNote");
  let photoDataUrl = null;

  photoInput.addEventListener("change", (e)=>{
    const f = e.target.files?.[0];
    if(!f){ photoDataUrl=null; photoPreview.style.display="none"; return; }
    const reader = new FileReader();
    reader.onload = ()=>{
      photoDataUrl = reader.result;
      photoPreview.src = photoDataUrl;
      photoPreview.style.display = "block";
    };
    reader.readAsDataURL(f);
  });

  function picked(){
    return ITEMS.filter(it => document.getElementById(it.id)?.checked);
  }

  function clamp(n,min,max){ return Math.max(min, Math.min(max,n)); }

  function diagnose(){
    const nm = (nameEl.value || "ã‚ãªãŸ").trim();
    const sel = picked();

    // ãƒ™ãƒ¼ã‚¹ã‚¹ã‚³ã‚¢ï¼ˆç››ã‚Šæ°—å‘³ã§æ°—æŒã¡ã‚ˆãï¼‰
    let score = 60;
    let rareHit = false, ultraHit = false;
    sel.forEach(it=>{
      score += it.w;
      if(it.rare) rareHit = true;
      if(it.ultra) ultraHit = true;
    });
    score = clamp(score, 55, 99);

    // ç§°å·ï¼ˆå¥³æ€§ãŒå¬‰ã—ã„è¨€è‘‰ã«å¯„ã›ã‚‹ï¼‰
    let title = "æ„›ã•ã‚Œå¼•åŠ›ã®æŒã¡ä¸»";
    if(ultraHit) title = "é‹å‘½ã‚’å›åã™ã‚‹å¥³ç‹";
    else if(rareHit) title = "ãƒ¢ãƒ†æœŸã‚’å‘¼ã¶å¹¸é‹ä½“è³ª";
    else if(score >= 90) title = "æ„›ã•ã‚Œã‚ªãƒ¼ãƒ©å…¨é–‹";

    // ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆï¼ˆè¤’ã‚ â†’ æœªæ¥ â†’ å®‰å¿ƒ â†’ è¡Œå‹•ï¼‰
    const loveParts = [];
    if(sel.some(x=>x.id==="emotionFork")) loveParts.push("æ„›æƒ…ã®æ·±ã•ãŒå¼·ã¿ã€‚ç›¸æ‰‹ã®å¿ƒã‚’ã»ã©ãã®ãŒä¸Šæ‰‹ã„ã€‚");
    if(sel.some(x=>x.id==="venusBand"))   loveParts.push("æƒ¹ãã¤ã‘ã‚‹é­…åŠ›ãŒã‚ã‚‹ã€‚é ‘å¼µã‚‰ãªãã¦ã‚‚å¥½æ„ãŒé›†ã¾ã‚Šã‚„ã™ã„ã€‚");
    if(sel.some(x=>x.id==="marriageMany"))loveParts.push("ã”ç¸ã®å…¥å£ãŒè¤‡æ•°ã‚ã‚‹ã‚¿ã‚¤ãƒ—ã€‚æ¯”è¼ƒã—ã¦â€œé¸ã¹ã‚‹â€é‹ã€‚");
    if(sel.some(x=>x.id==="marriageDeep"))loveParts.push("é–¢ä¿‚ãŒå½¢ã«ãªã‚Šã‚„ã™ã„ã€‚çœŸå‰£äº¤éš›ã«é€²ã¿ã‚„ã™ã„æµã‚Œã€‚");
    if(sel.some(x=>x.id==="loveLine"))    loveParts.push("é‹å‘½çš„ãªå‡ºä¼šã„ã®ã‚¹ã‚¤ãƒƒãƒãŒå…¥ã‚Šã‚„ã™ã„ã€‚ç´¹ä»‹ã‚„å¶ç„¶ã«å¼·ã„ã€‚");
    if(loveParts.length===0) loveParts.push("æ‹æ„›ã¯â€œè‚²ã¦ã‚‹ã»ã©å¼·ããªã‚‹â€ã‚¿ã‚¤ãƒ—ã€‚ç„¦ã‚‰ãªãã¦å¤§ä¸ˆå¤«ã€ã¡ã‚ƒã‚“ã¨é¸ã¹ã‚‹å´ã€‚");

    const luckParts = [];
    if(sel.some(x=>x.id==="sunLine"))     luckParts.push("äººæ°—é‹ãŒå‘³æ–¹ã€‚äººã«å¿œæ´ã•ã‚Œã‚‹ã»ã©é‹ãŒä¼¸ã³ã‚‹ã€‚");
    if(sel.some(x=>x.id==="solomon"))     luckParts.push("æœ›ã‚€ã‚‚ã®ã‚’å¼•ãå¯„ã›ã‚‹åŠ›ãŒå¼·ã„ï¼ˆè¶…ãƒ¬ã‚¢ï¼‰ã€‚ä¸»å°æ¨©ã‚’æ¡ã‚‹ã¨åŠ é€Ÿã™ã‚‹ã€‚");
    if(sel.some(x=>x.id==="star"))        luckParts.push("äºˆæœŸã›ã¬å¹¸é‹ãŒèµ·ãã‚„ã™ã„ã€‚å¬‰ã—ã„å¶ç„¶ã‚’å–ã‚Šã“ã¼ã•ãªã„ã§ã€‚");
    if(sel.some(x=>x.id==="venusHill"))   luckParts.push("ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒã‚ã‚‹ã€‚æ„›ã•ã‚Œã‚‹åœŸå°ãŒå¼·ã„ã€‚");
    if(sel.some(x=>x.id==="moonHill"))    luckParts.push("é›°å›²æ°—ã®é­…åŠ›ãŒæ­¦å™¨ã€‚æ„Ÿæ€§ã®åˆã†äººã¨ä¸€æ°—ã«è·é›¢ãŒç¸®ã‚€ã€‚");
    if(luckParts.length===0) luckParts.push("å¹¸é‹ã¯â€œäººã¨ã®å¾ªç’°â€ã§ä¼¸ã³ã‚‹ã€‚è¤’ã‚ã‚‰ã‚ŒãŸã‚‰å—ã‘å–ã‚‹ã»ã©é‹ãŒä¸ŠãŒã‚‹ã€‚");

    // ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆæ–­è¨€ã—ã™ããšã€æœŸå¾…ã‚’ä½œã‚‹ï¼‰
    const timing = ultraHit
      ? "ç›´è¿‘3ã€œ12ãƒ¶æœˆï¼šäººç”Ÿã®æµã‚ŒãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹ã€‚æ‹ã‚‚ä»•äº‹ã‚‚â€œé¸æŠãŒå½“ãŸã‚‹â€æ™‚æœŸã€‚"
      : rareHit
        ? "ç›´è¿‘1ã€œ6ãƒ¶æœˆï¼šãƒ¢ãƒ†æœŸã‚µã‚¤ãƒ³ã€‚èª˜ã„ãƒ»ç´¹ä»‹ãƒ»å¶ç„¶ã®å†ä¼šã«ä¹—ã‚‹ã¨ä¸€æ°—ã«é€²ã‚€ã€‚"
        : "ç›´è¿‘6ã€œ18ãƒ¶æœˆï¼šé–¢ä¿‚ãŒè‚²ã£ã¦å½¢ã«ãªã‚‹æ™‚æœŸã€‚ç„¦ã‚‰ãšâ€œã„ã„äººã ã‘æ®‹ã™â€ã®ãŒæ­£è§£ã€‚";

    // è¡Œå‹•ï¼ˆå…·ä½“çš„ã§è»½ã„ï¼‰
    const action = ultraHit
      ? "æ¬¡ã®ä¸€æ‰‹ï¼šè¿·ã£ãŸã‚‰â€œä¼šã†â€ã‚’é¸ã¶ã€‚ä¼šã£ãŸç¬é–“ã«å‹ã¦ã‚‹ã‚¿ã‚¤ãƒ—ã€‚"
      : rareHit
        ? "æ¬¡ã®ä¸€æ‰‹ï¼šèª˜ã„ã¯1å›ã ã‘ä¹—ã£ã¦ã¿ã¦ã€‚è¡Œã£ãŸå…ˆã§ã”ç¸ãŒç¹‹ãŒã‚‹ã€‚"
        : "æ¬¡ã®ä¸€æ‰‹ï¼šé€£çµ¡é »åº¦ã‚ˆã‚Šâ€œä¼šã†å›æ•°â€ã€‚çŸ­æ™‚é–“ã§ã‚‚ä¼šã†ã¨é‹ãŒå‹•ãã€‚";

    // UIåæ˜ 
    document.getElementById("title").textContent = `${nm}ã®ç§°å·ï¼š${title}`;
    document.getElementById("subtitle").textContent = `æ‹æ„›ãƒ»çµå©šãƒ»æ„›ã•ã‚Œé‹ã«å¼·ã„ã€å‰å‘ãæœªæ¥å‹ã®æ‰‹ç›¸`;
    document.getElementById("scorePill").textContent = `${score} / 100`;
    document.getElementById("bar").style.width = `${score}%`;
    document.getElementById("love").textContent = loveParts.join(" ");
    document.getElementById("luck").textContent = luckParts.join(" ");
    document.getElementById("timing").textContent = `ğŸ’ æœªæ¥ã®æµã‚Œï¼š${timing}`;
    document.getElementById("action").textContent = `âœ… ä»Šæ—¥ã‹ã‚‰ã®ä¸€æ‰‹ï¼š${action}`;

    // å†™çœŸåæ˜ ï¼ˆå°åˆ·ã«è¼‰ã‚‹ï¼‰
    if(photoDataUrl){
      photoResult.src = photoDataUrl;
      photoResult.style.display = "block";
      photoNote.textContent = "â€»ã“ã®å†™çœŸã¯ç«¯æœ«å†…ã§è¡¨ç¤ºã—ã¦ã„ã‚‹ã ã‘ï¼ˆã‚µãƒ¼ãƒãƒ¼é€ä¿¡ãªã—ï¼‰ã€‚";
    }else{
      photoResult.style.display = "none";
      photoNote.textContent = "å†™çœŸãªã—ã§ã‚‚OKã€‚å°åˆ·ã¯ãã®ã¾ã¾ã§ãã‚‹ã€‚";
    }

    resultCard.classList.add("show");
    resultCard.scrollIntoView({ behavior:"smooth", block:"start" });

    // ã‚·ã‚§ã‚¢æ–‡ã‚’ä½œã£ã¦ä¿æŒ
    window.__shareText = `ã€æ„›ã•ã‚Œæ‰‹ç›¸è¨ºæ–­ã€‘${nm}ï¼š${title}ï¼ˆæ„›ã•ã‚ŒæŒ‡æ•° ${score}/100ï¼‰ğŸ’–\næ‹æ„›ãƒ»çµå©šã®æµã‚Œï¼š${timing}\n#æ‰‹ç›¸å ã„ #æ‹æ„›é‹ #çµå©šé‹ #æ„›ã•ã‚Œ`;
  }

  document.getElementById("go").addEventListener("click", diagnose);

  document.getElementById("rand").addEventListener("click", ()=>{
    // â€œç››ã‚‹â€ï¼é«˜ç¢ºç‡ã§æ°—æŒã¡ã„ã„çµæœã«ãªã‚‹
    ITEMS.forEach(it=>{
      const cb = document.getElementById(it.id);
      let p = 0.45;
      if(it.id==="sunLine" || it.id==="emotionFork") p = 0.62;
      if(it.rare) p = 0.18;
      if(it.ultra) p = 0.07;
      cb.checked = Math.random() < p;
    });
  });

  document.getElementById("reset").addEventListener("click", ()=>{
    nameEl.value = "";
    ITEMS.forEach(it => document.getElementById(it.id).checked = false);
    resultCard.classList.remove("show");
    photoInput.value = "";
    photoDataUrl = null;
    photoPreview.style.display = "none";
  });

  document.getElementById("print").addEventListener("click", ()=>{
    // å°åˆ·ã¯ãƒ–ãƒ©ã‚¦ã‚¶æ©Ÿèƒ½ã§æœ€å¼·ï¼ˆPDFä¿å­˜ã‚‚ã§ãã‚‹ï¼‰
    window.print();
  });

  document.getElementById("share").addEventListener("click", async ()=>{
    const t = window.__shareText || "æ„›ã•ã‚Œæ‰‹ç›¸è¨ºæ–­ã—ã¦ã¿ãŸ #æ‰‹ç›¸å ã„";
    try{
      await navigator.clipboard.writeText(t);
      alert("ã‚·ã‚§ã‚¢æ–‡ã‚’ã‚³ãƒ”ãƒ¼ã—ãŸã‚ˆï¼");
    }catch(e){
      prompt("ã‚³ãƒ”ãƒ¼ã§ããªã‹ã£ãŸã‹ã‚‰æ‰‹å‹•ã‚³ãƒ”ãƒ¼ã—ã¦ã­", t);
    }
  });
</script>
</body>
</html>